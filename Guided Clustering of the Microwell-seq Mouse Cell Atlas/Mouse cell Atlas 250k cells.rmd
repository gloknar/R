---
title: "Tutorial eficiencia Seurat V3 MCA 250k"
author: "Adam Casas"
date: 'Compilado: `r format(Sys.Date(), "%d de %B del %Y")`'
output: 
  html_document:
    df_print: paged
    highlight: kate
    number_sections: yes
    theme: cerulean
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  tidy = TRUE
)
```

***

Adaptado de la guía publicada por el [laboratorio Satija](https://satijalab.org/seurat/v3.2/mca.html).

# Introducción al tutorial

En este tutorial vamos a mostrar un workflow para manejar datasets muy grandes, haciendo hincapié en el uso eficiente de la memoria y el tiempo de CPU de nuestro sistema. Por tanto, no analizaremos el sentido biológico de los clusters de células resultantes del workflow, aunque si te sientes preparado, te invitamos a que los analices por tu cuenta. Los análisis que realicemos en este tutorial se harán en la memoria RAM, aunque Seurat ha añadido recientemente soporte para realizar el análisis desde el disco duro mediante el framework [loom](http://loompy.org/). En esta [viñeta](https://satijalab.org/seurat/mca_loom.html) puedes ver este mismo workflow, pero usando [loomR](https://satijalab.org/loomR/loomR_tutorial.html).


***

<br>

# Workflow: Creamos el objeto `Seurat`

El dataset MCA (Mouse Cell Atlas) fue generado por [Xiaoping y compañeros, 2018](https://www.sciencedirect.com/science/article/pii/S0092867418301168), contiene 250000 células y está disponible en este [enlace](https://figshare.com/articles/dataset/MCA_DGE_Data/5435866). No obstante, para agilizar el workflow partimos directamente de un archivo `.rds` que contiene la matriz de expresión (=matriz de conteos UMI) y los metadatos ya combinados (archivo disponible en este [enlace](https://www.dropbox.com/s/8d8t4od38oojs6i/MCA.zip?dl=1))

```{r}
library(Seurat)
library(patchwork)
??patchwork



library(ggplot2)
p1 <- ggplot(mtcars) + 
  geom_point(aes(mpg, disp)) + 
  ggtitle('Plot 1')

p2 <- ggplot(mtcars) + 
  geom_boxplot(aes(gear, disp, group = gear)) + 
  ggtitle('Plot 2')

p1 + p2
```

